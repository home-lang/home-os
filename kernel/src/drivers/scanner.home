// home-os Scanner Driver
// Document scanning

import "../core/foundation.home" as foundation
import "../core/memory.home" as memory

const SCANNER_DPI_150: u32 = 150
const SCANNER_DPI_300: u32 = 300
const SCANNER_DPI_600: u32 = 600

var scanner_initialized: u32 = 0
var scanner_dpi: u32 = SCANNER_DPI_300

export fn scanner_init() {
  if scanner_initialized == 1 { return }
  
  scanner_dpi = SCANNER_DPI_300
  scanner_initialized = 1
  foundation.serial_write_string("[Scanner] Initialized\n")
}

export fn scanner_set_dpi(dpi: u32) {
  scanner_dpi = dpi
}

export fn scanner_scan(buffer: u64, width: u32, height: u32) -> u32 {
  if scanner_initialized == 0 { return 0 }
  
  foundation.serial_write_string("[Scanner] Scanning at ")
  foundation.serial_write_string(" DPI\n")
  
  // Scan document (stub)
  var size: u32 = width * height * 3
  return size
}
