// home-os Backlight Driver
// Screen brightness control

import "../core/foundation.home" as foundation

const BACKLIGHT_MAX: u32 = 100

var backlight_brightness: u32 = 80
var backlight_initialized: u32 = 0

export fn backlight_init() {
  if backlight_initialized == 1 { return }
  
  backlight_brightness = 80
  backlight_initialized = 1
  foundation.serial_write_string("[Backlight] Initialized\n")
}

export fn backlight_set_brightness(brightness: u32) {
  if brightness > BACKLIGHT_MAX {
    brightness = BACKLIGHT_MAX
  }
  
  backlight_brightness = brightness
  
  // Write to hardware (stub)
  foundation.serial_write_string("[Backlight] Brightness set to ")
  foundation.serial_write_string("\n")
}

export fn backlight_get_brightness() -> u32 {
  return backlight_brightness
}

export fn backlight_increase() {
  if backlight_brightness < BACKLIGHT_MAX {
    backlight_set_brightness(backlight_brightness + 10)
  }
}

export fn backlight_decrease() {
  if backlight_brightness > 10 {
    backlight_set_brightness(backlight_brightness - 10)
  }
}
