// HomeOS Locale: Arabic (Saudi Arabia)
// ar_SA locale data - RTL language

const basics = @import("basics")
const locale = @import("i18n/locale")

// Locale metadata
const LOCALE_CODE: [16]u8 = "ar_SA\0\0\0\0\0\0\0\0\0\0\0"
const LOCALE_NAME: [64]u8 = "Arabic (Saudi Arabia)"
const LOCALE_NATIVE: [64]u8 = "العربية (السعودية)"
const LANGUAGE_CODE: [8]u8 = "ar\0\0\0\0\0\0"
const COUNTRY_CODE: [8]u8 = "SA\0\0\0\0\0\0"

// Text direction - RTL
const TEXT_DIRECTION: u8 = 1  // RTL
const SCRIPT: [8]u8 = "Arab\0\0\0\0"

// Number formatting (uses Eastern Arabic numerals in display)
const DECIMAL_POINT: u8 = ','  // Arabic decimal separator
const THOUSANDS_SEP: u8 = '.'
const GROUPING: [4]u8 = [3, 3, 3, 0]

// Currency
const CURRENCY_SYMBOL: [8]u8 = "ر.س\0\0"  // SAR symbol
const CURRENCY_CODE: [4]u8 = "SAR\0"
const CURRENCY_DECIMALS: u8 = 2
const CURRENCY_POSITION: u8 = 1  // After number

// Date/Time formats
const DATE_FORMAT: [32]u8 = "dd/MM/yyyy\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
const TIME_FORMAT: [32]u8 = "hh:mm:ss a\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
const DATETIME_FORMAT: [48]u8 = "dd/MM/yyyy hh:mm:ss a\0"
const FIRST_DAY_OF_WEEK: u8 = 0  // Sunday

// AM/PM strings in Arabic
const AM_STRING: [8]u8 = "ص\0\0\0\0\0\0\0"
const PM_STRING: [8]u8 = "م\0\0\0\0\0\0\0"

// Month names (Gregorian calendar in Arabic)
const MONTH_NAMES: [12][16]u8 = [
    "يناير\0\0\0\0\0\0\0\0\0\0",
    "فبراير\0\0\0\0\0\0\0\0\0",
    "مارس\0\0\0\0\0\0\0\0\0\0\0",
    "أبريل\0\0\0\0\0\0\0\0\0\0",
    "مايو\0\0\0\0\0\0\0\0\0\0\0",
    "يونيو\0\0\0\0\0\0\0\0\0\0",
    "يوليو\0\0\0\0\0\0\0\0\0\0",
    "أغسطس\0\0\0\0\0\0\0\0\0",
    "سبتمبر\0\0\0\0\0\0\0\0\0",
    "أكتوبر\0\0\0\0\0\0\0\0\0",
    "نوفمبر\0\0\0\0\0\0\0\0\0",
    "ديسمبر\0\0\0\0\0\0\0\0\0"
]

// Day names
const DAY_NAMES: [7][16]u8 = [
    "الأحد\0\0\0\0\0\0\0\0\0\0",
    "الإثنين\0\0\0\0\0\0\0\0",
    "الثلاثاء\0\0\0\0\0\0\0",
    "الأربعاء\0\0\0\0\0\0\0",
    "الخميس\0\0\0\0\0\0\0\0\0",
    "الجمعة\0\0\0\0\0\0\0\0\0",
    "السبت\0\0\0\0\0\0\0\0\0\0"
]

// Arabic plural rules (6 forms!)
// zero: 0
// one: 1
// two: 2
// few: 3-10, x03-x10
// many: 11-99
// other: 100+
fn plural_rule(n: u64): u8 {
    if n == 0 {
        return 0  // PLURAL_ZERO
    }
    if n == 1 {
        return 1  // PLURAL_ONE
    }
    if n == 2 {
        return 2  // PLURAL_TWO
    }
    let n100 = n % 100
    if n100 >= 3 and n100 <= 10 {
        return 3  // PLURAL_FEW
    }
    if n100 >= 11 {
        return 4  // PLURAL_MANY
    }
    return 5  // PLURAL_OTHER
}

// Eastern Arabic numeral mapping
const EASTERN_ARABIC_DIGITS: [10][4]u8 = [
    "٠\0\0\0",  // 0
    "١\0\0\0",  // 1
    "٢\0\0\0",  // 2
    "٣\0\0\0",  // 3
    "٤\0\0\0",  // 4
    "٥\0\0\0",  // 5
    "٦\0\0\0",  // 6
    "٧\0\0\0",  // 7
    "٨\0\0\0",  // 8
    "٩\0\0\0"   // 9
]

// Convert Western Arabic numeral to Eastern Arabic
export fn to_eastern_arabic(digit: u8): *u8 {
    if digit >= '0' and digit <= '9' {
        return &EASTERN_ARABIC_DIGITS[digit - '0']
    }
    return null
}

// Register this locale
export fn ar_SA_register(): void {
    var data: locale.LocaleData

    basics.memcpy(&data.code, &LOCALE_CODE, 16)
    basics.memcpy(&data.name, &LOCALE_NAME, 64)
    basics.memcpy(&data.native_name, &LOCALE_NATIVE, 64)
    basics.memcpy(&data.language, &LANGUAGE_CODE, 8)
    basics.memcpy(&data.country, &COUNTRY_CODE, 8)

    data.direction = TEXT_DIRECTION  // RTL
    basics.memcpy(&data.script, &SCRIPT, 8)

    data.decimal_point = DECIMAL_POINT
    data.thousands_sep = THOUSANDS_SEP
    basics.memcpy(&data.grouping, &GROUPING, 4)

    basics.memcpy(&data.currency_symbol, &CURRENCY_SYMBOL, 8)
    basics.memcpy(&data.currency_code, &CURRENCY_CODE, 4)
    data.currency_decimal_digits = CURRENCY_DECIMALS
    data.currency_position = CURRENCY_POSITION

    basics.memcpy(&data.date_format, &DATE_FORMAT, 32)
    basics.memcpy(&data.time_format, &TIME_FORMAT, 32)
    basics.memcpy(&data.datetime_format, &DATETIME_FORMAT, 48)
    data.first_day_of_week = FIRST_DAY_OF_WEEK

    basics.memcpy(&data.am_string, &AM_STRING, 8)
    basics.memcpy(&data.pm_string, &PM_STRING, 8)

    basics.memcpy(&data.month_names, &MONTH_NAMES, 12 * 16)
    basics.memcpy(&data.day_names, &DAY_NAMES, 7 * 16)

    locale.locale_register(&data)
}
