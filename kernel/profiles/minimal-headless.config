# HomeOS Kernel Profile: Minimal Headless
# Target: 32MB kernel footprint, 64MB total system RAM
# Use case: IoT devices, embedded systems, headless servers with minimal requirements

# ============================================================================
# Profile Metadata
# ============================================================================
PROFILE=minimal-headless
PROFILE_DESCRIPTION="Minimal headless system for IoT and embedded devices"
TARGET_KERNEL_MB=32
TARGET_SYSTEM_MB=64

# ============================================================================
# Core Limits (Reduced for minimal footprint)
# ============================================================================
MAX_PROCESSES=64
MAX_FILES=128
MAX_SOCKETS=32
BUFFER_CACHE_MB=4
SLAB_CACHE_MB=2

# ============================================================================
# Memory Management
# ============================================================================
FEATURE_MM_ZRAM=yes
FEATURE_MM_SLAB=yes
FEATURE_MM_SWAP=no          # No swap for embedded
FEATURE_MM_MEMCG=no         # No cgroups needed
FEATURE_MM_HUGEPAGES=no

# ============================================================================
# Process Management
# ============================================================================
FEATURE_PROCESS_SMP=no      # Single core for simplicity
FEATURE_PROCESS_CGROUPS=no
FEATURE_PROCESS_CONTAINERS=no

# ============================================================================
# Security (Minimal)
# ============================================================================
FEATURE_SEC_CAPABILITIES=yes
FEATURE_SEC_SECCOMP=no
FEATURE_SEC_AUDIT=no
FEATURE_SEC_SMEP_SMAP=yes
FEATURE_SEC_KASAN=no

# ============================================================================
# Networking (Basic)
# ============================================================================
FEATURE_NET_TCP=yes
FEATURE_NET_UDP=yes
FEATURE_NET_ICMP=yes
FEATURE_NET_DHCP=yes
FEATURE_NET_DNS=yes
FEATURE_NET_HTTP=no
FEATURE_NET_TLS=no
FEATURE_NET_WEBSOCKET=no
FEATURE_NET_IPV6=no
FEATURE_NET_MQTT=no
FEATURE_NET_NFS=no
FEATURE_NET_SMB=no

# ============================================================================
# File Systems (Minimal)
# ============================================================================
FEATURE_FS_VFS=yes
FEATURE_FS_FAT32=yes
FEATURE_FS_EXT2=no
FEATURE_FS_TMPFS=yes
FEATURE_FS_PROCFS=yes
FEATURE_FS_SYSFS=no
FEATURE_FS_DEVFS=yes
FEATURE_FS_BTRFS=no
FEATURE_FS_NTFS=no
FEATURE_FS_ISO9660=no

# ============================================================================
# Hardware Drivers (Essential only)
# ============================================================================
FEATURE_DRV_ATA=no
FEATURE_DRV_AHCI=no
FEATURE_DRV_NVME=no
FEATURE_DRV_SDMMC=yes       # SD card for Pi
FEATURE_DRV_RAID=no
FEATURE_DRV_CDROM=no
FEATURE_DRV_FLOPPY=no

FEATURE_DRV_KEYBOARD=yes
FEATURE_DRV_MOUSE=no
FEATURE_DRV_TOUCHPAD=no
FEATURE_DRV_TOUCHSCREEN=no
FEATURE_DRV_GAMEPAD=no

FEATURE_DRV_E1000=no
FEATURE_DRV_RTL8139=no
FEATURE_DRV_VIRTIO_NET=no
FEATURE_DRV_WIFI=yes
FEATURE_DRV_BLUETOOTH=no

FEATURE_DRV_USB_UHCI=no
FEATURE_DRV_USB_EHCI=yes
FEATURE_DRV_USB_XHCI=no
FEATURE_DRV_USB_HUB=no

FEATURE_DRV_VGA=no
FEATURE_DRV_FRAMEBUFFER=no
FEATURE_DRV_GPU=no

FEATURE_DRV_PCI=no
FEATURE_DRV_ACPI=no
FEATURE_DRV_RTC=yes
FEATURE_DRV_TIMER=yes
FEATURE_DRV_SERIAL=yes

FEATURE_DRV_GPIO=yes
FEATURE_DRV_I2C=yes
FEATURE_DRV_SPI=yes
FEATURE_DRV_PWM=no
FEATURE_DRV_AUDIO=no
FEATURE_DRV_CAMERA=no

FEATURE_DRV_BATTERY=no
FEATURE_DRV_TPM=no
FEATURE_DRV_SENSORS=yes

# ============================================================================
# GUI (Disabled)
# ============================================================================
FEATURE_GUI_CRAFT=no
FEATURE_GUI_COMPOSITOR=no
FEATURE_GUI_VULKAN=no
FEATURE_GUI_OPENGL=no

# ============================================================================
# Performance & Debug (Minimal)
# ============================================================================
FEATURE_PERF_BOOT_OPT=yes
FEATURE_PERF_PROFILER=no
FEATURE_PERF_ASYNC_IO=no

FEATURE_DEBUG_GDB=no
FEATURE_DEBUG_PANIC=yes
FEATURE_DEBUG_MEMLEAK=no

# ============================================================================
# Optimization
# ============================================================================
OPTIMIZE=ReleaseSmall       # Optimize for size
STRIP_DEBUG=yes
LTO=yes                     # Enable LTO for smaller binary
