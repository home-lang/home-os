# HomeOS Kernel Profile: Server
# Target: 48MB kernel footprint, 256MB+ system RAM
# Use case: Web servers, file servers, headless application servers

# ============================================================================
# Profile Metadata
# ============================================================================
PROFILE=server
PROFILE_DESCRIPTION="Headless server with full networking and container support"
TARGET_KERNEL_MB=48
TARGET_SYSTEM_MB=256

# ============================================================================
# Core Limits (Server-scale)
# ============================================================================
MAX_PROCESSES=256
MAX_FILES=4096
MAX_SOCKETS=1024
BUFFER_CACHE_MB=32
SLAB_CACHE_MB=8

# ============================================================================
# Memory Management
# ============================================================================
FEATURE_MM_ZRAM=yes
FEATURE_MM_SLAB=yes
FEATURE_MM_SWAP=yes
FEATURE_MM_MEMCG=yes        # Cgroups for containers
FEATURE_MM_HUGEPAGES=yes    # Performance for VMs/DBs

# ============================================================================
# Process Management
# ============================================================================
FEATURE_PROCESS_SMP=yes     # Multi-core
FEATURE_PROCESS_CGROUPS=yes
FEATURE_PROCESS_CONTAINERS=yes

# ============================================================================
# Security (Full)
# ============================================================================
FEATURE_SEC_CAPABILITIES=yes
FEATURE_SEC_SECCOMP=yes
FEATURE_SEC_AUDIT=yes
FEATURE_SEC_SMEP_SMAP=yes
FEATURE_SEC_KASAN=no        # Disable in production

# ============================================================================
# Networking (Full stack)
# ============================================================================
FEATURE_NET_TCP=yes
FEATURE_NET_UDP=yes
FEATURE_NET_ICMP=yes
FEATURE_NET_DHCP=yes
FEATURE_NET_DNS=yes
FEATURE_NET_HTTP=yes
FEATURE_NET_TLS=yes
FEATURE_NET_WEBSOCKET=yes
FEATURE_NET_IPV6=yes
FEATURE_NET_MQTT=yes
FEATURE_NET_NFS=yes
FEATURE_NET_SMB=yes

# ============================================================================
# File Systems (Full)
# ============================================================================
FEATURE_FS_VFS=yes
FEATURE_FS_FAT32=yes
FEATURE_FS_EXT2=yes
FEATURE_FS_TMPFS=yes
FEATURE_FS_PROCFS=yes
FEATURE_FS_SYSFS=yes
FEATURE_FS_DEVFS=yes
FEATURE_FS_BTRFS=yes
FEATURE_FS_NTFS=yes
FEATURE_FS_ISO9660=no

# ============================================================================
# Hardware Drivers (Server-oriented)
# ============================================================================
FEATURE_DRV_ATA=yes
FEATURE_DRV_AHCI=yes
FEATURE_DRV_NVME=yes
FEATURE_DRV_SDMMC=yes
FEATURE_DRV_RAID=yes
FEATURE_DRV_CDROM=no
FEATURE_DRV_FLOPPY=no

FEATURE_DRV_KEYBOARD=yes
FEATURE_DRV_MOUSE=no
FEATURE_DRV_TOUCHPAD=no
FEATURE_DRV_TOUCHSCREEN=no
FEATURE_DRV_GAMEPAD=no

FEATURE_DRV_E1000=yes
FEATURE_DRV_RTL8139=yes
FEATURE_DRV_VIRTIO_NET=yes
FEATURE_DRV_WIFI=yes
FEATURE_DRV_BLUETOOTH=no

FEATURE_DRV_USB_UHCI=yes
FEATURE_DRV_USB_EHCI=yes
FEATURE_DRV_USB_XHCI=yes
FEATURE_DRV_USB_HUB=yes

FEATURE_DRV_VGA=no          # Headless
FEATURE_DRV_FRAMEBUFFER=no
FEATURE_DRV_GPU=no

FEATURE_DRV_PCI=yes
FEATURE_DRV_ACPI=yes
FEATURE_DRV_RTC=yes
FEATURE_DRV_TIMER=yes
FEATURE_DRV_SERIAL=yes

FEATURE_DRV_GPIO=yes
FEATURE_DRV_I2C=yes
FEATURE_DRV_SPI=yes
FEATURE_DRV_PWM=no
FEATURE_DRV_AUDIO=no
FEATURE_DRV_CAMERA=no

FEATURE_DRV_BATTERY=no
FEATURE_DRV_TPM=yes
FEATURE_DRV_SENSORS=yes

# ============================================================================
# GUI (Disabled)
# ============================================================================
FEATURE_GUI_CRAFT=no
FEATURE_GUI_COMPOSITOR=no
FEATURE_GUI_VULKAN=no
FEATURE_GUI_OPENGL=no

# ============================================================================
# Performance & Debug
# ============================================================================
FEATURE_PERF_BOOT_OPT=yes
FEATURE_PERF_PROFILER=yes
FEATURE_PERF_ASYNC_IO=yes

FEATURE_DEBUG_GDB=yes
FEATURE_DEBUG_PANIC=yes
FEATURE_DEBUG_MEMLEAK=no

# ============================================================================
# Optimization
# ============================================================================
OPTIMIZE=ReleaseSafe
STRIP_DEBUG=yes
LTO=no
