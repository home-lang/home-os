// home-os Mount
// Mount filesystems

import "../../kernel/src/core/foundation.home" as foundation
import "../../kernel/src/core/filesystem.home" as filesystem

export fn mount_main(device: u64, mountpoint: u64, fstype: u64) {
  foundation.vga_clear()
  foundation.vga_write_string("=== Mount ===\n\n")
  
  foundation.vga_write_string("Mounting ")
  foundation.vga_write_string(device)
  foundation.vga_write_string(" on ")
  foundation.vga_write_string(mountpoint)
  foundation.vga_write_string(" (")
  foundation.vga_write_string(fstype)
  foundation.vga_write_string(")\n")
  
  var result: u32 = filesystem.vfs_mount(device, mountpoint, fstype)
  
  if result == 0 {
    foundation.vga_write_string("Success!\n")
  } else {
    foundation.vga_write_string("Failed!\n")
  }
}

export fn mount_list() {
  foundation.vga_clear()
  foundation.vga_write_string("=== Mounted Filesystems ===\n\n")
  foundation.vga_write_string("Device      Mountpoint  Type\n")
  foundation.vga_write_string("------      ----------  ----\n")
  foundation.vga_write_string("/dev/sda1   /           ext2\n")
  foundation.vga_write_string("/dev/sda2   /home       ext2\n")
  foundation.vga_write_string("tmpfs       /tmp        tmpfs\n")
}
