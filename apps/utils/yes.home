// home-os Yes
// Output a string repeatedly

import "../../kernel/src/core/foundation.home" as foundation
import "../../kernel/src/drivers/keyboard.home" as keyboard

export fn yes_main(text: u64) {
  var default_text: [u8; 2] = "y"
  var output: u64 = text
  
  if text == 0 {
    output = @ptrFromInt(default_text)
  }
  
  var running: u32 = 1
  while running == 1 {
    foundation.vga_write_string(output)
    foundation.vga_write_string("\n")
    
    // Check for interrupt
    if keyboard.keyboard_has_char() == 1 {
      var ch: u8 = keyboard.keyboard_getchar()
      if ch == 3 {  // Ctrl+C
        running = 0
      }
    }
  }
}
